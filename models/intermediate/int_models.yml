version: 2

models:
  - name: int_claims_enriched
    description: "Unified inpatient/outpatient claims enriched with beneficiary demographics, chronic conditions, provider info, and fraud-related derived metrics."
    columns:
      - name: claimid
        description: "Unique claim identifier"
        tests:
          - not_null
      - name: beneid
        description: "Beneficiary ID (patient)"
        tests:
          - not_null
      - name: provider
        description: "Provider ID associated with the claim"
        tests:
          - not_null
      - name: age_at_claim
        description: "Age of patient at claim date"
      - name: is_post_death_claim
        description: "Flag if claim occurred after patient’s date of death"
        tests:
          - accepted_values:
              arguments:
                values: [0, 1]
      - name: reimbursed_amount
        description: "Reimbursed claim amount"
      - name: deductible_paid
        description: "Patient deductible paid"
      - name: reimbursed_to_deductible_ratio
        description: "Ratio of reimbursement to deductible"
      - name: length_of_stay
        description: "Length of inpatient stay in days"

  - name: int_claims_diagnosis_long
    description: "Exploded claim-diagnosis mapping, one row per diagnosis code per claim."
    columns:
      - name: claimid
        description: "Unique claim identifier"
        tests:
          - not_null
      - name: diagnosis_code
        description: "Diagnosis ICD code associated with the claim"
        tests:
          - not_null

  - name: int_claims_procedure_long
    description: "Exploded claim-procedure mapping, one row per procedure code per claim."
    columns:
      - name: claimid
        description: "Unique claim identifier"
        tests:
          - not_null
      - name: procedure_code
        description: "Procedure CPT/HCPCS code associated with the claim"
        tests:
          - not_null

  - name: int_provider_aggregates
    description: "Provider-level aggregates summarizing claim behavior, reimbursement patterns, and fraud signals."
    columns:
      - name: provider
        description: "Unique provider identifier"
        tests:
          - not_null
          - unique
      - name: total_claims
        description: "Total claims submitted by provider"
      - name: unique_patients
        description: "Unique patients served by provider"
      - name: avg_claim_amount
        description: "Average reimbursement amount per claim"
      - name: post_death_claims
        description: "Count of claims submitted for deceased patients"
      - name: potentialfraud
        description: "Known fraud label from provider data"
        tests:
          - accepted_values:
              arguments:
                values: [0, 1]

  - name: int_patient_aggregates
    description: "Patient-level aggregates summarizing utilization patterns, financials, and fraud signals."
    columns:
      - name: beneid
        description: "Unique patient identifier"
        tests:
          - not_null
          - unique
      - name: total_claims
        description: "Total claims submitted for patient"
      - name: unique_providers
        description: "Unique providers visited by patient"
      - name: chronic_condition_count
        description: "Number of chronic conditions for patient"
      - name: post_death_claims
        description: "Number of claims filed after patient’s date of death"
      - name: high_value_claims
        description: "Number of high reimbursement claims for patient"
