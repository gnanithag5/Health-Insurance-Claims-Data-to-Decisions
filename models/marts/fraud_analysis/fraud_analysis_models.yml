version: 2

models:
  - name: fct_claims
    description: "Master fact table of enriched claims with patient, provider, and fraud-related features."
    columns:
      - name: claimid
        description: "Unique claim identifier"
        tests: [not_null, unique]
      - name: beneid
        description: "Beneficiary (patient) ID"
        tests: [not_null]
      - name: provider
        description: "Provider ID"
        tests: [not_null]
      - name: is_post_death_claim
        description: "Flag for whether claim date is after patient's date of death"
        tests:
          - accepted_values:
              arguments:
                values: [0, 1]
      - name: potentialfraud
        description: "Known provider fraud label (from source data)"
        tests:
          - accepted_values:
              arguments:  
                values: [0, 1]

  - name: fct_claim_diagnoses
    description: "Fact table of diagnoses tied to each claim (long format)."
    columns:
      - name: claimid
        description: "Claim identifier (foreign key to fct_claims)"
        tests: [not_null]
      - name: diagnosis_code
        description: "ICD-10 diagnosis code"
        tests: [not_null]

  - name: fct_claim_procedures
    description: "Fact table of procedures tied to each claim (long format)."
    columns:
      - name: claimid
        description: "Claim identifier (foreign key to fct_claims)"
        tests: [not_null]
      - name: procedure_code
        description: "Procedure code (CPT/HCPCS)"
        tests: [not_null]

  - name: dim_provider_fraud_signals
    description: "Provider-level fraud signals and aggregated metrics."
    columns:
      - name: provider
        description: "Provider ID"
        tests: [not_null, unique]
      - name: total_claims
        description: "Total claims submitted by provider"
      - name: post_death_claims
        description: "Count of claims for deceased patients"
      - name: potentialfraud
        description: "Known fraud label"
        tests:
          - accepted_values:
              arguments:
                values: [0, 1]

  - name: dim_patient_utilization
    description: "Patient-level fraud signals and utilization metrics."
    columns:
      - name: beneid
        description: "Patient ID"
        tests: [not_null, unique]
      - name: total_claims
        description: "Total number of claims for the patient"
      - name: unique_providers
        description: "Unique providers visited by patient"
      - name: post_death_claims
        description: "Number of claims after death"
      - name: chronic_condition_count
        description: "Count of chronic conditions recorded for the patient"
